<p align="center">
  <a href="#">
    <img width="400" src="https://github.com/3Tecnos-Development/mono/assets/5139981/ec6daa7c-9107-46ae-9389-1e20e93cca39">
  </a>
</p>
<h1 align="center" style="color:purple">X-School</h1>

<h1 align="center">Curso de Desenvolvimento Full Stack com Node.js, React Native e Monorepo NX (DDD e SOLID)</h1>

<h1 align="center">DDD (Domain-driven Design)</h1>

### Aula 04

#### Domain Service

Um "Domain Service" (ServiÃ§o do DomÃ­nio) Ã© um conceito no contexto do Domain-Driven Design (DDD) que representa uma peÃ§a chave de lÃ³gica de negÃ³cios que nÃ£o se encaixa bem nas responsabilidades de uma Ãºnica Entidade ou de um Agregado. Em vez disso, um Domain Service Ã© usado para encapsular operaÃ§Ãµes ou lÃ³gicas que nÃ£o fazem sentido serem associadas a um objeto especÃ­fico do domÃ­nio, mas ainda sÃ£o parte fundamental do processo de negÃ³cio.

CaracterÃ­sticas:

1. LÃ³gica de DomÃ­nio Complexa
   > [!NOTE] <span style="color:purple"> Domain Services sÃ£o usados para encapsular lÃ³gica de domÃ­nio que Ã© complexa, especializada ou que abrange vÃ¡rios objetos do domÃ­nio.
2. Sem Identidade
   > [!NOTE] <span style="color:purple"> Ao contrÃ¡rio das Entidades, os Domain Services nÃ£o tÃªm identidade prÃ³pria. Eles sÃ£o definidos por suas funcionalidades e operaÃ§Ãµes, nÃ£o por seus atributos ou identificadores.
3. ComparaÃ§Ã£o de Valores
   > [!NOTE] <span style="color:purple"> A comparaÃ§Ã£o entre Value Objects deve ser baseada na comparaÃ§Ã£o de seus atributos, e nÃ£o em alguma referÃªncia de identificaÃ§Ã£o.
4. NÃ£o MantÃªm Estado
   > [!NOTE] <span style="color:purple"> Em geral, os Domain Services nÃ£o mantÃªm estado entre chamadas. Eles sÃ£o criados, usados para executar uma operaÃ§Ã£o especÃ­fica e depois descartados.
5. Promovendo SeparaÃ§Ã£o de Responsabilidades
   > [!NOTE] <span style="color:purple"> Domain Services ajudam a manter a coesÃ£o e a separaÃ§Ã£o de responsabilidades, evitando que lÃ³gicas complexas se espalhem por vÃ¡rias partes do cÃ³digo.

##### Vejamos alguns exemplos:

ðŸ’¡ Domain Service _desativarServidor_

```typescript
import { checkRules } from "@3tecnos/guards";

import { Servidor, Lancamento } from "../../entities";
import { validarDesativacaoDoServidor } from "../rules";

const garantirInativacaodoServidor = async (servidor: Servidor, lancamento: Lancamento) => {
  await checkRules(validarDesativacaoDoServidor(servidor, lancamento));
};

export const desativarServidor = async (
  servidor: Servidor,
  lancamento: Lancamento
): { servidor: Servidor; lancamento: lancamento } => {
  await garantirInativacaodoServidor(servidor, lancamento);

  servidor.inativar();

  lancamento.excluirFolhas();

  return { servidor, lancamento };
};
```

ðŸ’¡ CheckRule _validarDesativacaoDoServidor_

```typescript
import { CheckRuleFunction } from "@3tecnos/guards";
import { OperationNotAllowedException } from "@3tecnos/exceptions";
import { Serializable } from "@3tecnos/serialization";
import { Servidor, Lancamento } from "../../../entities";

@Serializable("yHUfbasUokcbiYTsUi1Dj")
export class ServidorNaoPodeSerInativadoException extends OperationNotAllowedException {
  constructor(message?: string, original?: Error) {
    super(message, original);
    this.setName("PrazoDaDataExcedidoException");
  }
}

export function validarDesativacaoDoServidor(servidor: Servidor, lancamento: Lancamento): CheckRuleFunction {
  return async function () {
    const existeLancamentoBloqueado = lancamento.existeLancamentoBloqueadoNaCompetencia;

    if (!servidor.podeInativar) {
      throw new ServidorNaoPodeSerInativadoException("O servidor nÃ£o pode ser desativado.");
    }

    if (existeLancamentoBloqueado) {
      throw new ServidorNaoPodeSerInativadoException("O servidor possui lanÃ§amentos bloqueados.");
    }
  };
}
```
